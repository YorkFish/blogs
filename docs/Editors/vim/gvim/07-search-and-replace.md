# 7. 搜索与替换

!!! info
    适用于 **编辑模式**

## 1. 搜索

### 全文搜索

#### 方法一

- `/` + 要搜索的内容 + <kbd>Enter</kbd>
- 若搜到，粗光标会停在第一个词的首位
- 若有多个
    - 按 <kbd>n</kbd> 跳至下一处
    - 按 <kbd>N</kbd> 跳至上一处

#### 方法二

- `?` + 要搜索的内容 + <kbd>Enter</kbd>
- 若搜到，粗光标会停在有该词的最后一行的第一个词的首位
- 若有多个
  - 按 <kbd>N</kbd> 跳至下一处
  - 按 <kbd>n</kbd> 跳至上一处

#### 方法三

- 使用快捷键
- <kbd>Shift</kbd> + <kbd>\*</kbd> : 向下搜索粗光标停留处的词
- <kbd>Shift</kbd> + <kbd>\#</kbd> : 向上搜索粗光标停留处的词
- <kbd>g</kbd> + <kbd>d</kbd> : 从头开始搜索粗光标停留处的词，搭配 <kbd>n</kbd> 与 <kbd>N</kbd> 使用

!!! tip
    - 若搜索时需要忽略大小写，使用命令 `:set ic`
        - 或者在配置文件 `_vimrc` 中添加命令 `set ic`
    - 搜索成功后会有高亮，若要消去高亮，可以使用 `:nohlsearch`
        - 用 `:nohlsearch` 的缩写 `:noh` 也行

## 2. 替换

### 普通替换

| 命令 | 释义 |
| :---: | :--- |
| **r** | 取代粗光标处的字符 |
| **R** | 从粗光标处的字符开始，往后连续替换字符，按 <kbd>Esc</kbd> 结束 |

### 定位替换

| 命令 | 释义 |
| :--- | :--- |
| **:s/old/new** | 将本行第一个 `old` 替换成 `new` |
| **:s/old/new/g** | 将本行所有的 `old` 替换成 `new` |
| **:%s/old/new/g** | 将全文所有的 `old` 替换成 `new` |
| **:n1,n2s/old/new/g** | 将第 `n1` 行到第 `n2` 行的 `old` 替换成 `new` |
| **:n1,n2s/old/new/gc** | 1. 在上一条基础上，每替换一个都要确认<br>2. 后续命令 `y/n/a/q/l` 分别代表 <br>`确认/跳过/之后的全部/取消/换一个就结束` |

!!! note
    - `old` 和 `new` 是虚指，实际用时由具体字符串代替
    - `n1` 和 `n2` 是虚指，实际用时由具体数字代替

### 知识点

- `g` 表示“全局替换”
- `%` 表示“当前文件”
- 不妨设为 `test.py`，且其绝对路径是 `D:\Test\test.py`

    | 符号 | 释义 | 结果 |
    | :---: | :--- | :--- |
    | % | 文件名 | test.py |
    | %:t | 文件名 | test.py |
    | %:r | 去除扩展名后的文件名 | test |
    | %< | 去除扩展名后的文件名 | test |
    | %:e | 扩展名 | py |
    | %:p | 完整路径名 | `D:\Test\test.py` |
    | %:h | 文件所在目录 | `.` |
